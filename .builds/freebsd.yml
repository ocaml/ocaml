image: freebsd/latest
packages:
  - gmake
  - pkgconf
  - zstd
sources:
  - https://github.com/ocaml/ocaml
environment:
  OCAMLRUNPARAM: "b,v=0"
tasks:
  - configure: |
      cd ocaml
      ./configure --enable-debug-runtime \
        --enable-flambda --enable-cmm-invariants \
        --enable-dependency-generation \
        --enable-native-toplevel
  - build: |
      cd ocaml
      gmake
  - test: |
      cd ocaml
      gmake tests

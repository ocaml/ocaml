# -*- Makefile -*-

#**************************************************************************
#*                                                                        *
#*                                 OCaml                                  *
#*                                                                        *
#*            Xavier Leroy, projet Cristal, INRIA Rocquencourt            *
#*                                                                        *
#*   Copyright 2002 Institut National de Recherche en Informatique et     *
#*     en Automatique.                                                    *
#*                                                                        *
#*   All rights reserved.  This file is distributed under the terms of    *
#*   the GNU Lesser General Public License version 2.1, with the          *
#*   special exception on linking described in the file LICENSE.          *
#*                                                                        *
#**************************************************************************

# This file must be self-contained.

# It lists all standard library modules and is used by:
# 1. stdlib/Makefile to build stdlib.cma
# 2. Makefile to expunge the toplevels
# 3. api_docgen/Makefile.docfiles to compute all documentation files which
#    need to be generated for the stdlib

# Three variables are exported:
# $(STDLIB_MODULE_BASENAMES) - basenames, in dependency order, of the modules in
#    the stdlib
# $(STDLIB_PREFIXED_MODULES) - just the namespaced modules of
#    $(STDLIB_MODULE_BASENAMES), i.e. without camlinternal* and stdlib. Used in
#    stdlib/Makefile to munge the dependencies.
# $(STDLIB_MODULES) - full list, in prefixed form as appropriate.

# Basenames of the source files for the standard library (i.e. unprefixed and
# with lowercase first letters). These must be listed in dependency order.
STDLIB_MODULE_BASENAMES = \
  CamlinternalFormatBasics CamlinternalAtomic \
  Stdlib Pervasives Seq Option Either Result Bool Char Uchar \
  Sys List Int Bytes String Unit Marshal Obj Array Float Int32 Int64 Nativeint \
  Lexing Parsing Set Map Stack Queue CamlinternalLazy Lazy Stream Buffer \
  CamlinternalFormat Printf Arg Atomic \
  Printexc Fun Gc Digest Random Hashtbl Weak \
  Format Scanf Callback CamlinternalOO Oo CamlinternalMod Genlex Ephemeron \
  Filename Complex ArrayLabels ListLabels BytesLabels StringLabels MoreLabels \
  StdLabels Bigarray

STDLIB_PREFIXED_MODULES = \
  $(filter-out Stdlib Camlinternal%, $(STDLIB_MODULE_BASENAMES))

# add Stdlib__ as prefix to a module except for internal modules
# and the stdlib module itself
define add_stdlib_prefix
  $(or $(filter-out $(STDLIB_PREFIXED_MODULES), $1), \
    Stdlib__$(1))
endef

STDLIB_MODULES := \
  $(foreach module, $(STDLIB_MODULE_BASENAMES), \
    $(call add_stdlib_prefix,$(module)))
